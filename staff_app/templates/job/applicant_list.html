<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>List of Applicants</title>
</head>
<body>
  
{% extends "staff_maintemp/nav.html" %}
{% block content %}
<h2>Applicants for {{ job.title }} ({{ job.job_number }})</h2>

<p>Only pending applicants are shown here. Accepting or rejecting will move them to the appropriate list.</p>

<table border="1" cellspacing="0" cellpadding="8">
  <thead>
    <tr>
      <th>Applicant</th>
      <th>Applied At</th>
      <th>CV</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for app in applicants %}
      <tr>
        <td>{{ app.applicant.get_full_name }} ({{ app.applicant.username }})</td>
        <td>{{ app.applied_at|date:"M d, Y h:i A" }}</td>
        <td>
          {% if app.cv %}
            <a href="{{ app.cv.url }}" target="_blank" rel="noopener noreferrer">View CV</a>
          {% else %}
            <span style="color: #999;">No CV</span>
          {% endif %}
        </td>
        <td>
          {% if app.status == 'accepted' %}
            <span style="color: green; font-weight: bold;">Accepted</span>
          {% elif app.status == 'rejected' %}
            <span style="color: red; font-weight: bold;">Rejected</span>
          {% else %}
            <span style="color: #555;">Pending</span>
          {% endif %}
        </td>
        <td>
          <form method="post" action="{% url 'staff_url:review_applicant' app.id 'accept' %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" style="background-color:green; color:white;">Accept</button>
          </form>

          <form method="post" action="{% url 'staff_url:review_applicant' app.id 'reject' %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" style="background-color:red; color:white;" onclick="return confirm('Reject this applicant?')">Reject</button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5" style="text-align:center;">No applicants yet.</td></tr>
    {% endfor %}
  </tbody>
</table>

<p><a href="{% url 'staff_url:post_list' %}">‚Üê Back to job posts</a></p>
{% endblock %}


</body>
</html>