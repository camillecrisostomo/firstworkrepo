<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Registration</title>
</head>
<body>

{% include "nav.html" %}

<h2>User Registration</h2>

{% if messages %}
  {% for m in messages %}
    <div>
      <strong>{{ m }}</strong>
    </div>
  {% endfor %}
{% endif %}

<form method="post" novalidate>
  {% csrf_token %}

  <fieldset>
    <legend><strong>Personal Information</strong></legend>

    <label for="id_first_name">First Name:</label><br>
    <input type="text" name="first_name" id="id_first_name" value="{{ form.first_name.value|default:'' }}" required><br>
    {% if form.first_name.errors %}
      <ul>
        {% for error in form.first_name.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}

    <label for="id_middle_name">Middle Name:</label><br>
    <input type="text" name="middle_name" id="id_middle_name" value="{{ form.middle_name.value|default:'' }}"><br>
    {% if form.middle_name.errors %}
      <ul>
        {% for error in form.middle_name.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}

    <label for="id_last_name">Last Name:</label><br>
    <input type="text" name="last_name" id="id_last_name" value="{{ form.last_name.value|default:'' }}" required><br>
    {% if form.last_name.errors %}
      <ul>
        {% for error in form.last_name.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}
  </fieldset>

  <fieldset>
    <legend><strong>Account Information</strong></legend>

    <label for="id_email">Email:</label><br>
    <input type="email" name="email" id="id_email" value="{{ form.email.value|default:'' }}" required><br>
    {% if form.email.errors %}
      <ul>
        {% for error in form.email.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}

    <label for="id_password">Password:</label><br>
    <input type="password" name="password" id="id_password" required><br>
    {% if form.password.errors %}
      <ul>
        {% for error in form.password.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}

    <label for="id_confirm_password">Confirm Password:</label><br>
    <input type="password" name="confirm_password" id="id_confirm_password" required><br>
    {% if form.confirm_password.errors %}
      <ul>
        {% for error in form.confirm_password.errors %}
          <li><strong>{{ error }}</strong></li>
        {% endfor %}
      </ul>
    {% endif %}
  </fieldset>

  {% if form.non_field_errors %}
    <ul>
      {% for error in form.non_field_errors %}
        <li><strong>{{ error }}</strong></li>
      {% endfor %}
    </ul>
  {% endif %}

  <button type="submit">Register</button>
</form>

<p>Already registered? <a href="{% url 'user:login' %}">Login</a></p>

{% if show_modal and user_id %}
  <div>
    <h3>Email Verification</h3>
    <form method="post" action="{% url 'user:verify' user_id %}">
      {% csrf_token %}
      <label>Verification Code:</label><br>
      <input type="text" name="code" maxlength="10" required><br><br>
      <button type="submit">Verify</button>
    </form>
    <p>
      Didn't receive the code?
      <a href="{% url 'user:resend' user_id %}">Resend code</a>
    </p>
  </div>
{% endif %}

</body>
</html>
