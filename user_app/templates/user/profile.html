{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
</head>
<body>

{% include "user_maintemp/nav.html" %}

<h1>Profile</h1>

{% if messages %}
    {% for message in messages %}
        <div>
            <strong>{{ message }}</strong>
        </div>
    {% endfor %}
{% endif %}

<form id="profileForm" method="post" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    
    <table border="1" cellpadding="10" cellspacing="0" width="100%">
        <tr valign="top">
            <td width="220">
                {% if profile.profile_image %}
                    <img id="previewImage" src="{{ profile.profile_image.url }}" alt="Profile" width="200">
                {% else %}
                    <img id="previewImage" src="{% static 'defaults/default_profile.jpg' %}" alt="Profile" width="200">
                {% endif %}
                
                <div>
                    <label for="{{ profile_form.profile_image.id_for_label }}">{{ profile_form.profile_image.label }}:</label><br>
                    {{ profile_form.profile_image }}
                </div>
                
                {% if profile_form.profile_image.errors %}
                    <ul>
                        {% for error in profile_form.profile_image.errors %}
                            <li><strong>{{ error }}</strong></li>
                        {% endfor %}
                    </ul>
                {% endif %}
                
                <p><em>Allowed: image files</em></p>
            </td>
            
            <td>
                <fieldset>
                    <legend><strong>Account Information</strong></legend>
                    
                    <table border="0" width="100%">
                        <tr>
                            <td width="150"><label for="{{ user_form.first_name.id_for_label }}">{{ user_form.first_name.label }}:</label></td>
                            <td>{{ user_form.first_name }}</td>
                        </tr>
                        {% if user_form.first_name.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in user_form.first_name.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                        
                        <tr>
                            <td><label for="{{ profile_form.middle_name.id_for_label }}">{{ profile_form.middle_name.label }}:</label></td>
                            <td>{{ profile_form.middle_name }}</td>
                        </tr>
                        {% if profile_form.middle_name.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in profile_form.middle_name.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                        
                        <tr>
                            <td><label for="{{ user_form.last_name.id_for_label }}">{{ user_form.last_name.label }}:</label></td>
                            <td>{{ user_form.last_name }}</td>
                        </tr>
                        {% if user_form.last_name.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in user_form.last_name.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                        
                        <tr>
                            <td><label for="{{ user_form.email.id_for_label }}">{{ user_form.email.label }}:</label></td>
                            <td>{{ user_form.email }}</td>
                        </tr>
                        {% if user_form.email.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in user_form.email.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                    </table>
                </fieldset>
                
                <fieldset>
                    <legend><strong>Change Password (Optional)</strong></legend>
                    
                    <table border="0" width="100%">
                        <tr>
                            <td width="150"><label for="{{ password_form.password.id_for_label }}">{{ password_form.password.label }}:</label></td>
                            <td>{{ password_form.password }}</td>
                        </tr>
                        {% if password_form.password.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in password_form.password.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                        
                        <tr>
                            <td><label for="{{ password_form.confirm_password.id_for_label }}">{{ password_form.confirm_password.label }}:</label></td>
                            <td>{{ password_form.confirm_password }}</td>
                        </tr>
                        {% if password_form.confirm_password.errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in password_form.confirm_password.errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                        
                        {% if password_form.non_field_errors %}
                            <tr>
                                <td colspan="2">
                                    <ul>
                                        {% for error in password_form.non_field_errors %}
                                            <li><strong>{{ error }}</strong></li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                        {% endif %}
                    </table>
                    
                    <p><em>Leave blank if you don't want to change password</em></p>
                </fieldset>
            </td>
        </tr>
    </table>
    
    <hr>
    
    <p>
        <button id="saveBtn" type="submit" disabled>Save Changes</button>
        <a href="{% url 'user:dashboard' %}">Cancel</a>
    </p>
</form>

<script src="{% static 'staff_app/js/profile.js' %}"></script>

</body>
</html>
